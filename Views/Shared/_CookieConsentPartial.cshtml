<div id="cookieConsent" class="position-fixed bottom-0 start-0 w-100 shadow-lg" style="z-index: 99999; display: none; background: rgba(255,255,255,0.95); color: #222; border-radius: 1rem 1rem 0 0; font-size: 1rem; backdrop-filter: blur(10px);">
    <div class="container d-flex flex-column flex-md-row align-items-center justify-content-between gap-2 py-3">
        <div class="mb-2 mb-md-0" style="line-height: 1.5;">
            Sitemiz, deneyiminizi iyileştirmek ve hizmetlerimizi geliştirmek için çerezler kullanır. Detaylar için <a href="/KVKK/Gizlilik" class="text-primary text-decoration-underline">Gizlilik Politikası</a>'nı inceleyin.
        </div>
        <div class="d-flex gap-2">
            <button id="customizeCookie" class="btn btn-outline-primary btn-sm rounded-pill px-3">Kişiselleştir</button>
            <button id="rejectCookie" class="btn btn-outline-danger btn-sm rounded-pill px-3">Reddet</button>
            <button id="acceptCookie" class="btn btn-primary btn-sm rounded-pill px-3">Kabul Et</button>
        </div>
    </div>
</div>

<!-- Kişiselleştir Modalı -->
<div class="modal fade" id="cookieModal" tabindex="-1" aria-labelledby="cookieModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="cookieModalLabel">Çerez Tercihleri</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Kapat"></button>
      </div>
      <div class="modal-body">
        <form id="cookieSettingsForm">
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" value="necessary" id="cookieNecessary" checked disabled>
            <label class="form-check-label" for="cookieNecessary">
              Zorunlu Çerezler <span class="text-muted small">(Site için gereklidir)</span>
            </label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" value="analytics" id="cookieAnalytics">
            <label class="form-check-label" for="cookieAnalytics">
              Analitik Çerezler <span class="text-muted small">(Site kullanımını analiz eder)</span>
            </label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" value="ads" id="cookieAds">
            <label class="form-check-label" for="cookieAds">
              Pazarlama Çerezleri <span class="text-muted small">(Kişiselleştirilmiş reklamlar için)</span>
            </label>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary btn-sm rounded-pill" data-bs-dismiss="modal">Vazgeç</button>
        <button type="button" class="btn btn-primary btn-sm rounded-pill" id="saveCookieSettings">Kaydet</button>
      </div>
    </div>
  </div>
</div>

<script>
    // Cookie consent functionality
    (function() {
        'use strict';
        
        function hideCookieBar() {
            const cookieBar = document.getElementById('cookieConsent');
            if (cookieBar) {
                cookieBar.style.display = 'none';
            }
        }
        
        function showCookieBar() {
            const cookieBar = document.getElementById('cookieConsent');
            if (cookieBar) {
                cookieBar.style.display = 'block';
            }
        }
        
        function saveCookiePreference(preference) {
            try {
                localStorage.setItem('cookieAccepted', preference);
                hideCookieBar();
            } catch (error) {
                console.error('Cookie preference could not be saved:', error);
            }
        }
        
        function showCookieModal() {
            try {
                const modalElement = document.getElementById('cookieModal');
                if (modalElement && typeof bootstrap !== 'undefined') {
                    const modal = new bootstrap.Modal(modalElement);
                    modal.show();
                } else {
                    console.warn('Bootstrap modal not available');
                }
            } catch (error) {
                console.error('Error showing cookie modal:', error);
            }
        }
        
        function hideCookieModal() {
            try {
                const modalElement = document.getElementById('cookieModal');
                if (modalElement && typeof bootstrap !== 'undefined') {
                    const modal = bootstrap.Modal.getInstance(modalElement);
                    if (modal) {
                        modal.hide();
                    }
                }
            } catch (error) {
                console.error('Error hiding cookie modal:', error);
            }
        }
        
        function saveCookieSettings() {
            try {
                const analytics = document.getElementById('cookieAnalytics')?.checked || false;
                const ads = document.getElementById('cookieAds')?.checked || false;
                const settings = { necessary: true, analytics: analytics, ads: ads };
                
                localStorage.setItem('cookieAccepted', JSON.stringify(settings));
                hideCookieBar();
                hideCookieModal();
            } catch (error) {
                console.error('Error saving cookie settings:', error);
            }
        }
        
        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // Check if user has already made a choice
                const cookieAccepted = localStorage.getItem('cookieAccepted');
                if (!cookieAccepted) {
                    showCookieBar();
                }
                
                // Event listeners
                const acceptBtn = document.getElementById('acceptCookie');
                const rejectBtn = document.getElementById('rejectCookie');
                const customizeBtn = document.getElementById('customizeCookie');
                const saveSettingsBtn = document.getElementById('saveCookieSettings');
                
                if (acceptBtn) {
                    acceptBtn.addEventListener('click', function() {
                        saveCookiePreference('all');
                    });
                }
                
                if (rejectBtn) {
                    rejectBtn.addEventListener('click', function() {
                        saveCookiePreference('necessary');
                    });
                }
                
                if (customizeBtn) {
                    customizeBtn.addEventListener('click', function() {
                        showCookieModal();
                    });
                }
                
                if (saveSettingsBtn) {
                    saveSettingsBtn.addEventListener('click', function() {
                        saveCookieSettings();
                    });
                }
                
            } catch (error) {
                console.error('Error initializing cookie consent:', error);
            }
        });
        
    })();
</script> 